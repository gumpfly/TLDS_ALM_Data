# Folder structure

* [**Release_LDSI_v3**](../Release_LDSI_v3) --- LDSI code version 3.0 (*Matlab*); Potentially changed to *Python* in later version.
* [**Readme**](../Readme)  --- Latex files for a detail calculation of code
* [**Testing**](./) --- A list of file used for tests of simulated neural system
* [**Testing/Plots**](./Plots) -- A list of functions for plot styles

#Testing Folder

## 1. Functions
* [SimulateLDS.m](./SimulateLDS.m) --- A code for simulated neural activity with single stage
* [SimulateLDS_MultiStage.m](./SimulateLDS_MultiStage.m) --- A code for simulated neural activity with multiple stage
* [stochastic.m](./stochastic.m) --- A code from SSID (subspace identification) for estimates of parameters

## 2. Testing files
* [Test_State_Variable.m](./Test_State_Variable.m) --- Test for goodness of fits for a **one-dimensional** latent variable system. For this case, one can in fact exam whether the fitted latent system is the similar to the original one. In plot, the black line stands for the original latent dynamics, and the red line stands for the fitted latent dynamics ([Test_latent.pdf](./Test_latent.pdf)). In the default setting, there are 4 stages (and thus the breaking points are those between stages).
![Test_latent.pdf](Test_latent.pdf)

 * [Test_Arti_Neural_Data.m](./Test_Arti_Neural_Data.m) --- Test for goodness of fit for a __single stage one-dimensional__ latent variable system, where spike count is either generated by a Poisson (Part 1 of the code) or Log-normal (Part 2 of the code) process. Specifically,

	>
	>__Poisson spike count generation__
	>
	>Spike counts: Y(t) = Poiss(exp(Z(t)))
	>
	>Spike rate: Z(t) = Cx(t)
	>
	>Latent dynamics: x(t) = Ax(t-1) + w(t)
	
	>__Log-normal spike count generation__
	>
	>Spike counts: Y(t) = Round(exp(Z(t)))
	>
	>Spike rate: Z(t) = Cx(t) + v(t)
	>
	>Latent dynamics: x(t) = Ax(t-1) + w(t)

Here is an exemplary comparison between original and fitted latent neural dynamics using Log-normal after running this code.	
* [Test_Arti_Neural_Data_Multiple_Latent_Variables.m](./Test_Arti_Neural_Data_Multiple_Latent_Variables.m) --- The same as [Test_Arti_Neural_Data.m](./Test_Arti_Neural_Data.m), expect it generates the data for multiple stages.
* [Test_Arti_Neural_Data_Percentage_Explained.m](./Test_Arti_Neural_Data_Percentage_Explained.m) --- The same as [Test_Arti_Neural_Data.m](./Test_Arti_Neural_Data.m), expect it generates the data from *multi-dimensional* latent variables (_xDim_ > 2) and __one stage__. Plots includes comparison of explained variance, BIC and AIC as fitted by different numbers of latent dimensions. Also the comparison of Y (grey lines), $Y_{exp}$ (red lines) and $Y_{est}$ (blue lines).

	>Simulated neural data: Y(t) = Cx(t) + v(t)
	>
	>Latent dynamics: x(t) = Ax(t-1) + w(t)
	>
	>Expectation of simulated neural data: $Y_{exp}$(t) = Cx(t)
	>
	>Estimation of neural data: $Y_{est}(t) = \bar{C} \bar{x}(t)$
* [Test_Nuo_data_analysis_LDS.m](./Test_Nuo_data_analysis_LDS.m) ---  Example fits using data [ANM219033_20131116.mat](./ANM219033_20131116.mat) (which is already preprocessed).
	* Fig 1. observed neural activity
	* Fig 2. estimated neural activity using xDim = 3 (by default)
	* Fig 3. latent dynamics in each dimension
	* Fig 3+. if xDim == 3, then plot the latent dynamics in 3-D space
	* Fig 4 - 6. The same thing but for error trials
	* Fig 7+. Trial-by-trial variability
